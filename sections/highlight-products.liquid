<style>
  /* Custom scroll bar configuration */
  .md\:custom-scrollbar::-webkit-scrollbar {
    height: 12px;
  }
  .md\:custom-scrollbar::-webkit-scrollbar-track {
    background-color: #e5e7eb;
    border-radius: 10px;
    border: 4px solid transparent;
    background-clip: content-box;
  }
  .md\:custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #231f20;
    border-radius: 10px;
    border: 4px solid transparent;
    background-clip: content-box;
    transition: border-width 0.2s ease-in-out;
  }
  .md\:custom-scrollbar::-webkit-scrollbar-thumb:hover,
  .md\:custom-scrollbar::-webkit-scrollbar-thumb:active {
    background-color: #231f20;
    border: 3px solid transparent;
  }
</style>

<div
  class="font-sans text-gray-900"
>
  <div
    class="max-w-7xl"
  >
    <!-- Header -->
    <div class="flex md:justify-between items-end mb-8 justify-center">
      <h1
        class="font-bold md:font-black md:text-[40px] text-[28px] leading-[1.2] tracking-[-0.01em] text-gray-900 md:px-2"
        style="font-family: 'Source Serif Pro', serif"
      >
        {{ section.settings.title }}
      </h1>
      <a
        href="{{ section.settings.collection.url }}"
        class="hidden md:flex items-center text-sm font-semibold text-gray-600 hover:text-black transition-colors md:px-2"
      >
        Shop All Best Sellers
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4 ml-1"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M14 5l7 7m0 0l-7 7m7-7H3"
          />
        </svg>
      </a>
    </div>

    <!-- Product Grid/Scroll -->
    <div
      id="product-grid"
      class="grid grid-cols-2 gap-4 pb-0 md:flex md:overflow-x-auto md:gap-6 md:pb-8 md:snap-x md:snap-mandatory md:custom-scrollbar md:mx-0 md:px-2 md:py-2 -mx-6 px-6"
    >
      {% for product in section.settings.collection.products limit: 10 %}
        <a
          href="{{ product.selected_or_first_available_variant.url }}"
        >
          <div class="group cursor-pointer w-full md:w-auto md:w-[300px] md:snap-center md:flex-shrink-0 origin-top transition-all duration-500 ease-out {% if forloop.index > 4 %} extra-product-mobile {% endif %}">
            <div
              class="relative rounded-2xl overflow-hidden aspect-square mb-4 transition-transform group-hover:scale-[1.05] md:h-[300px]"
            >
              {% if product.tags[0] %}
                <span
                  class="absolute top-[4px] left-[4px] md:top-4 md:left-4 backdrop-blur-sm px-2 py-1 font-bold uppercase tracking-wider rounded-full border border-black text-black md:text-[10px] text-[8px] bg-[{{ product.tags[0] | split: ':' | first }}]"
                  style="z-index: 1"
                >
                  {{- product.tags[0] | split: ':' | last -}}
                </span>
              {% endif %}
              {% if product.tags[1] %}
                <span
                  class="absolute top-[4px] right-[4px] md:top-4 md:right-4 text-black px-2 py-1 font-bold uppercase tracking-wider rounded-full md:text-[10px] text-[8px] border border-black bg-[{{ product.tags[1] | split: ':' | first }}]"
                  style="z-index: 1"
                >
                  {{- product.tags[1] | split: ':' | last -}}
                </span>
              {% endif %}
              <div class="absolute inset-0">
                <!-- Default Image -->
                {{
                  product.images[0]
                  | image_url: width: 600
                  | image_tag:
                    class: 'w-full h-full object-cover',
                    style: 'z-index: 1'
                }}
                <!-- Hover Image -->
                {{
                  product.images[1]
                  | image_url: width: 600
                  | image_tag:
                    class: 'absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-300 group-hover:opacity-100',
                    style: 'z-index: 1'
                }}
              </div>
            </div>
            <h3
              class="font-bebas text-[18px] font-normal leading-none tracking-[0.03em] uppercase mb-1"
              style="font-family: 'Bebas Neue'"
            >
              {{ product.title }}
            </h3>
            <div class="flex items-center mb-1">
              <div class="flex text-gray-900 text-xs">★★★</div>
              <div class="flex text-gray-300 text-xs">★★</div>
              <span class="text-[10px] text-gray-400 ml-1">1,234 Reviews</span>
            </div>
            <div class="text-sm" style="font-family: 'Poppins'">
              {{ product.price | money_with_currency }}
            </div>
          </div>
        </a>
      {% endfor %}
    </div>

    <!-- Mobile Shop All Link (layout shift) -->
    <div id="show-more-container" class="mt-3 md:hidden flex justify-center">
      <button
        id="show-more-btn"
        class="w-full bg-[#111827] text-white py-4 text-sm hover:bg-gray-800 transition-colors rounded-[100px]"
      >
        Show More
      </button>
    </div>

    <script>
      document
        .getElementById('show-more-btn')
        .addEventListener('click', function () {
          const container = document.getElementById('product-grid');
          const hiddenItems = document.querySelectorAll(
            '.extra-product-mobile'
          );
          const btnContainer = document.getElementById('show-more-container');

          hiddenItems.forEach((item, index) => {
            item.classList.remove('hidden');
            // Small stagger or immediate reveal
            item.style.animationDelay = `${index * 100}ms`;
            item.classList.add('animate-fade-in-up');
          });

          // Hide the button
          btnContainer.style.display = 'none';

          // Smooth scroll to the first revealed item
          if (hiddenItems.length > 0) {
            hiddenItems[0].scrollIntoView({
              behavior: 'smooth',
              block: 'start',
            });
          }
        });

      // Check if screen is mobile
      const isMobile = window.innerWidth < 768;
      if (isMobile) {
        const hiddenItems = document.querySelectorAll('.extra-product-mobile');
        hiddenItems.forEach((item, index) => {
          item.classList.add('hidden');
        });
      }
    </script>
  </div>
</div>

{% schema %}
{
  "name": "Highlight Products",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title"
    }
  ]
}
{% endschema %}
